# SYS\_TIME\_CallbackRegisterUS Function

**Parent topic:**[Library Interface](GUID-3D84F884-122D-4A4A-95DA-DFD8C2E84650.md)

## C

```c
SYS_TIME_HANDLE SYS_TIME_CallbackRegisterUS(
    SYS_TIME_CALLBACK callback,
    uintptr_t context,
    uint32_t us,
    SYS_TIME_CALLBACK_TYPE type
);
```

## Summary

Registers a function with the time system service to be called back when the requested number of microseconds have expired \(either once or repeatedly\).

## Description

Creates a timer object and registers a function with it to be called back<br />when the requested delay \(specified in microseconds\) has completed. The<br />caller must identify if the timer should call the function once or repeatedly<br />every time the given delay period expires.

## Precondition

The SYS\_TIME\_Initialize function should have been called before calling this function.

## Parameters

|Param|Description|
|-----|-----------|
|callback|Pointer to the function to be called. For single shot timers, the callback cannot be NULL. For periodic timers, if the callback pointer is given as NULL, no callback will occur, but SYS\_TIME\_TimerPeriodHasExpired can still be polled to determine if the period has expired for a periodic timer.|
|context|A client-defined value that is passed to the callback function.|
|us|Time period in microseconds.|
|type|Type of callback requested. If type is SYS\_TIME\_SINGLE, the Callback function will be called once when the time period expires. After the time period expires, the timer object will be freed. If type is SYS\_TIME\_PERIODIC Callback function will be called repeatedly, every time the time period expires until the timer object is stopped or deleted.|

## Returns

*SYS\_TIME\_HANDLE* - A valid timer object handle if the call succeeds.

*SYS\_TIME\_HANDLE\_INVALID* if it fails.

## Example

Given a callback function implementation matching the following prototype:

```c
void MyCallback ( uintptr_t context);
```

The following example call will register it, requesting a 500 microsecond periodic callback.

```c
//Give a SYS_TIME_CALLBACK function "MyCallback",
SYS_TIME_HANDLE handle = SYS_TIME_CallbackRegisterUS(MyCallback, (uintptr_t)0, 500, SYS_TIME_PERIODIC);

if (handle != SYS_TIME_HANDLE_INVALID)
{
    //timer is created successfully.
}
```

## Remarks

Will give a callback after the requested number of microseconds or longer have elapsed, depending on system performance. In tick-based mode, the requested delay will be ceiled to the next timer tick.

For example, if the timer tick is set to 1 msec and the requested delay is 1500 usec, a delay of 2 msec will be generated.

Delay values of 0 will return SYS\_TIME\_ERROR.

