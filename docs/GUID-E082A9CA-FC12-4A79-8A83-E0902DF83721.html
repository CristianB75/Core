<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Configuring The Library" />
<meta name="DC.relation" scheme="URI" content="GUID-7D1381D7-9A05-495B-B0A8-D195FA444618.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="configuring-the-library" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Configuring The Library</title>
<meta name="Microsoft.Help.Id" content="GUID-EDFB1AB8-CD6B-446F-8E25-F2167287A1AF-configuring-the-library" />
<meta name="Microsoft.Help.TocParent" content="GUID-EDFB1AB8-CD6B-446F-8E25-F2167287A1AF" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLABÂ® Harmony Core Library Reference A 11/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-E082A9CA-FC12-4A79-8A83-E0902DF83721"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="configuring-the-library">
<h1 class="title topictitle1" id="ariaid-title1">Configuring The Library</h1><div class="body"><p class="p">Emulated EEPROM Library should be configured via MHC. The following figures show the MHC configuration window for Emulated EEPROM and brief description.</p>
<p class="p"><strong class="ph b">Emulated EEPROM in Project Gaph</strong></p>
<br /><img class="image" src="GUID-33D0B7B6-1F6F-49F5-8B51-C84EFE164B78-low.png" alt="emulated_eeprom_mhc_config_project_graph" /><br /><p class="p"><strong class="ph b">Emulated EEPROM library with Main Array region used for EEPROM Emulation address space on Cortex M0+ devices</strong></p>
<ul class="ul"><li class="li"><p class="p">The EEPROM size is configured through fuse settings in MHC on M0+ devices.</p>
</li>
</ul>
<br /><img class="image" src="GUID-10AA0EFC-7DFD-4BA6-BDBB-C21B5B777BBA-low.png" alt="emulated_eeprom_mhc_config_with_main_array_cortex_m0" /><br /><p class="p"><strong class="ph b">Emulated EEPROM library with RWWEE region used for EEPROM Emulation address space on Cortex M0+ devices</strong></p>
<ul class="ul"><li class="li"><p class="p">The RWWEE size is fixed and it uses the full RWWEE space available on that device.</p>
</li>
</ul>
<br /><img class="image" src="GUID-6C850DD6-71BF-4D9F-BB63-C9DB2800177B-low.png" alt="emulated_eeprom_mhc_config_with_rwwee_cortex_m0" /><br /><p class="p"><strong class="ph b">Emulated EEPROM library with Main Array region used for EEPROM Emulation address space on Cortex M4/M7 devices</strong></p>
<br /><img class="image" src="GUID-83BEA2C0-BA44-4C40-A9B7-98131CB0E3E4-low.png" alt="emulated_eeprom_mhc_config_with_main_array_cortex_m4_m7" /><br /><p class="p"><strong class="ph b">Configuration Options</strong></p>
<ul class="ul"><li class="li"><p class="p"><strong class="ph b">EEPROM Emulation Address Space</strong></p>
<ul class="ul"><li class="li"><p class="p">Indicates the memory space used for EEPROM Emulation</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">EEPROM Size (in Erase Sectors)</strong></p>
<ul class="ul"><li class="li"><p class="p">Size of EEPROM Emulation region specified by user in terms of Erase sectors.</p>
</li>
<li class="li"><p class="p">For example, on SAM E70, the erase sector size is 8192 bytes. Hence, EEPROM Emulation region must be atleast 16384 bytes or more.</p>
</li>
<li class="li"><p class="p">This is because, one sector will be reserved as spare and the data from full row will be copied to the spare row when a write request is made to the full row.</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">EEPROM Start Address / EEPROM Emulation Start Address</strong></p>
<ul class="ul"><li class="li"><p class="p">Indicates the start address of the EEPROM Emulation region</p>
</li>
<li class="li"><p class="p">If main array is used, then the EEPROM Emulation region is allocated from the end of the main array.</p>
<ul class="ul"><li class="li"><p class="p">For example, if the total size of main array is 256 KB (0x40000), and the EEPROM Emulation size is 2048 bytes, then the 2048 bytes will be allocated from the end of the main array and the EEPROM Emulation region will start from 256KB - 2KB = 254KB (0x3F800).</p>
</li>
</ul>
</li>
<li class="li"><p class="p">If RWWEE region is used, the EEPROM Emulation region is allocated from the start of the RWWEE region and the entire RWWEE region is used as EEPROM Emulation region.</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Number of Physical Pages</strong></p>
<ul class="ul"><li class="li"><p class="p">Indicates total number of physical pages in the EEPROM Emulation region.</p>
</li>
<li class="li"><p class="p">For example, on M0+ devices a page is of 64 bytes. Hence, if EEPROM Emulation region size is 2048 bytes, total number of physical pages will be 2048/64 = 32</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Number of Logical Pages</strong></p>
<ul class="ul"><li class="li"><p class="p">Indicates total number of logical pages in the EEPROM Emulation region</p>
</li>
<li class="li"><p class="p">For example, on M0+ devices, a row consists of 4 pages. On such devices each row only stores data for 2 logical pages. Hence the total number of logical pages is halved.</p>
</li>
<li class="li"><p class="p">In addition, one row (4 pages) are reserved for spare row. Hence, if the total number of physical pages in EEPROM Emulation region is 32 (i.e. 8 rows), the number of local pages will be:</p>
<ul class="ul"><li class="li"><p class="p">Total Rows - Spare Row = 8 - 1 = 7 rows.</p>
</li>
</ul>
</li>
<li class="li"><p class="p">Each row can store 2 logical pages. Hence total logical pages = 7 * 2 = 14 logical pages.</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Logical EEPROM Size (Bytes)</strong></p>
<ul class="ul"><li class="li"><p class="p">Indicates total logical space available in terms of bytes</p>
</li>
<li class="li"><p class="p">Each page reserves 4 bytes for storing internal data which is used by the EEPROM Emulation library</p>
</li>
<li class="li"><p class="p">Hence, if the total number of logical pages is 14 and if the page size is 64 bytes, then total logical EEPROM size in bytes will be 14 x (64-4) = 14 x 60 = 840 bytes.</p>
</li>
</ul>
</li>
</ul>
<p class="p"><strong class="ph b">Note:</strong></p>
<p class="p">In each case, the total size of EEPROM Emulation region must be greater than or equal to two Erase Sectors.</p>
<ul class="ul"><li class="li"><p class="p">For example, on SAM C21, the erase size is one row. Size of one row is 256 bytes. Hence EEPROM Emulation region must be 512 bytes or more.</p>
</li>
<li class="li"><p class="p">Similarly on SAM E70, the erase size is 8192 bytes. Hence, EEPROM Emulation region must be atleast 16384 bytes or more.</p>
</li>
</ul>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-7D1381D7-9A05-495B-B0A8-D195FA444618.html">Emulated EEPROM</a></div>
</div>
</div></body>
</html>