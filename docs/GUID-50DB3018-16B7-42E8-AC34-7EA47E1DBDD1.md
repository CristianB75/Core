# I2C\_BB\_WriteRead Function

**Parent topic:**[Library Interface](GUID-6CBA8AA0-7EF7-44B1-8D12-CD6A3067E53A.md)

## C

```c
bool I2C_BB_WriteRead(uint16_t address, uint8_t* wdata, size_t wlength, uint8_t* rdata, size_t rlength)
```

## Summary

Write and Read data from Slave.

## Description

This function writes data from the wdata to the bus and then reads data from<br />the slave and stores the received in the rdata. The function generates a<br />Start condition on the bus and will then send wlength number of bytes<br />contained in wdata. The function will then insert a Repeated start condition<br />and proceed to read rlength number of bytes from the slave. The received<br />bytes are stored in rdata buffer. A Stop condition is generated after the<br />last byte has been received.

If the slave NAKs the request , the transfer is terminated. The application<br />can call I2C\_BB\_ErrorGet\(\) function to know that cause of the error.

The function is non-blocking. It initiates bus activity and returns<br />immediately. The transfer is then completed in the timer peripheral interrupt.<br />A transfer request cannot be placed when another transfer is in progress.<br />Calling this function when another function is already in progress will<br />cause the function to return false.

The library will call the registered callback function when the transfer has<br />terminated.

## Precondition

I2C\_BB\_Initialize must have been called for the associated I2C instance.

## Parameters

|Param|Description|
|-----|-----------|
|address|7-bit / 10-bit slave address.|
|wdata|pointer to write data buffer|
|wlength|write data length in bytes.|
|rdata|pointer to read data buffer.|
|rlength|read data length in bytes.|

## Returns

*true* - The request was placed successfully and the bus activity was initiated.

*false* - The request fails, if there was already a transfer in progress when this function was called.

## Example

```c
uint8_t myTxData [NUM_TX_BYTES] = {'1', '0', ' ', 'B', 'Y', 'T', 'E', 'S'};
uint8_t myRxData [NUM_RX_BYTES] = {0};
    
void MyI2CCallback(uintptr_t context)
{
    // This function will be called when the transfer completes. Note
    // that this function executes in the context of the I2C interrupt.
}

I2C_BB_Initialize();

I2C_BB_CallbackRegister(MyI2CCallback, NULL);

if(I2C_BB_WriteRead( SLAVE_ADDR, &myTxData[0], NUM_TX_BYTES, myRxData, NUM_RX_BYTES ) == false)
{
    // error handling
}

```

## Remarks

Calling this function is not the same as calling the I2C\_BB\_Write\(\) function and then calling the I2C\_BB\_Read\(\) function.

The I2C\_BB\_WriteRead function will insert a Repeated Start condition between the Write and the Read stages. The I2C\_BB\_Write\(\) and the I2C\_BB\_Read\(\) function insert a stop condition after the write and the read has completed.

